<div class="row">
<div class="col-md-3">
    <h5>TODO</h5>
    <div class="add-button" data-bs-toggle="modal" data-bs-target="#exampleModalTodo">Add <i
            class="fa fa-plus-circle mx-2" aria-hidden="true"></i></div>

    <div class="modal fade" id="exampleModalTodo" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Add new Task</h1>
                    <button type="button" class="btn-close mt-2" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="{% url 'create_task' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="team_id" value="{{team.team_id}}">
                        <input type="hidden" name="status" value="todo">

                        <div class="form-group">
                            <label for="title">Title</label>
                            <input type="text" name="title" id="title" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea name="description" id="description" class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="title">Start Date</label>
                            <input type="date" name="start_date" id="start_date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="title">End Date</label>
                            <input type="date" name="end_date" id="end_date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="title">Priority</label>
                            <select name="priority" id="" class="form-select">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary mt-2" data-bs-dismiss="modal">
                                Create</button>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
    <div class="tasks d-flex flex-column " id="todo">

    </div>
</div>
<div class="col-md-3">
    <h5>INPROGRESS</h5>
    <div class="add-button" data-bs-toggle="modal" data-bs-target="#exampleModalProgress">Add <i
            class="fa fa-plus-circle mx-2" aria-hidden="true"></i></div>

    <div class="modal fade" id="exampleModalProgress" tabindex="-1" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Add new Task</h1>
                    <button type="button" class="btn-close mt-2" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="{% url 'create_task' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="team_id" value="{{team.team_id}}">
                        <input type="hidden" name="status" value="progress">

                        <div class="form-group">
                            <label for="title">Title</label>
                            <input type="text" name="title" id="title" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea name="description" id="description" class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="title">Start Date</label>
                            <input type="date" name="start_date" id="start_date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="title">End Date</label>
                            <input type="date" name="end_date" id="end_date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="title">Priority</label>
                            <select name="priority" id="" class="form-select">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary mt-2" data-bs-dismiss="modal">
                                Create</button>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
    <div class="tasks d-flex flex-column " id="progress">

    </div>
</div>
<div class="col-md-3">
    <h5>NEED REVIEW</h5>
    <div class="add-button" data-bs-toggle="modal" data-bs-target="#exampleModalReview">Add <i
            class="fa fa-plus-circle mx-2" aria-hidden="true"></i></div>

    <div class="modal fade" id="exampleModalReview" tabindex="-1" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Add new Task</h1>
                    <button type="button" class="btn-close mt-2" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="{% url 'create_task' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="team_id" value="{{team.team_id}}">
                        <input type="hidden" name="status" value="review">

                        <div class="form-group">
                            <label for="title">Title</label>
                            <input type="text" name="title" id="title" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea name="description" id="description" class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="title">Start Date</label>
                            <input type="date" name="start_date" id="start_date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="title">End Date</label>
                            <input type="date" name="end_date" id="end_date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="title">Priority</label>
                            <select name="priority" id="" class="form-select">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary mt-2" data-bs-dismiss="modal">
                                Create</button>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
    <div class="tasks d-flex flex-column " id="review">

    </div>
</div>
<div class="col-md-3">
    <h5>COMPLETED</h5>
    <div class="add-button" data-bs-toggle="modal" data-bs-target="#exampleModalDone">Add <i
            class="fa fa-plus-circle mx-2" aria-hidden="true"></i></div>

    <div class="modal fade" id="exampleModalDone" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Add new Task</h1>
                    <button type="button" class="btn-close mt-2" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="{% url 'create_task' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="team_id" value="{{team.team_id}}">
                        <input type="hidden" name="status" value="done">

                        <div class="form-group">
                            <label for="title">Title</label>
                            <input type="text" name="title" id="title" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea name="description" id="description" class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="title">Start Date</label>
                            <input type="date" name="start_date" id="start_date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="title">End Date</label>
                            <input type="date" name="end_date" id="end_date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="title">Priority</label>
                            <select name="priority" id="" class="form-select">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary mt-2" data-bs-dismiss="modal">
                                Create</button>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
    <div class="tasks d-flex flex-column " id="done">

    </div>
</div>
</div>


<script>
    $(document).ready(function () {
        $.get('/taskmanager/tasks', function (data) {
            console.log(data);
            for (var i = 0; i < data.length; i++) {
                var task = data[i];
                let people = task.assigned_to.map(function (person) {
                    return `<div class="person">${person.name[0]}</div>`;
                }).join("");
                var taskDiv = `
                    <div class="task py-2">
                        <div class="priority priority-${task.priority}">${task.priority}</div>
                        <div class="task-title">${task.title}</div>
                        <div class="task-description">${task.description}</div>
                        <div class="task-due">
                            <i class="fa fa-calendar" aria-hidden="true"></i>
                            ${task.end_date}</div>
                            <div class="persons">
                                ${people}
                            </div>

                        <a href="/taskmanager/task/${task.id}"><div><span class="text-primary">View task</span></div></a>
                    </div>
                `;

                $('#' + task.status).append(taskDiv);
            }
        });
    });

</script>